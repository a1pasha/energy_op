=================================================================
GOOGLE COLAB SCRIPT 3 - HIGHER POPULATION
Account: Third Google account
Run: 150 gen, 100 pop, seed=42
=================================================================

CELL 1: Mount Drive
-------------------
from google.colab import drive
drive.mount('/content/drive')


CELL 2: Extract Files
-------------------
import zipfile
import os

zip_path = '/content/drive/MyDrive/Energy_Optimization/optimization.zip'
extract_to = '/content/optimization'

with zipfile.ZipFile(zip_path, 'r') as zip_ref:
    zip_ref.extractall(extract_to)

os.chdir('/content/optimization/Multi-Object NSGA2 optimization')
print("✓ Files extracted")


CELL 3: Install Dependencies
-------------------
!apt-get install -y glpk-utils
!pip install pandas numpy matplotlib pyomo pymoo scikit-learn
!pip install oemof.solph==0.5.1


CELL 4: Force GLPK
-------------------
!pip uninstall -y gurobipy
print("✓ Gurobi removed, will use GLPK")


CELL 5: Run Pop=100 Optimization
-------------------
import subprocess

print("Starting POP=100 run: 150 gen, 100 pop, seed=42")
print("NOTE: Higher population = better Pareto front")

inputs = "150\n100\n2\n"

with open('run_optimization.sh', 'w') as f:
    f.write('#!/bin/bash\n')
    f.write(f'echo "{inputs}" | python main.py > optimization.log 2>&1\n')

!chmod +x run_optimization.sh
!nohup ./run_optimization.sh &

print("✓ Optimization started with pop=100")
print("Estimated: 12-14 hours (larger population)")


CELL 6: Monitor Progress
-------------------
import time
import glob
import os

print("Checking every 30 minutes...")

while True:
    results = glob.glob('nsga2_results/run_*')
    if results:
        latest = sorted(results)[-1]
        if os.path.exists(f"{latest}/pareto_solutions.csv"):
            print("\n✓✓✓ COMPLETE! ✓✓✓")
            break
        files = len(os.listdir(latest))
        print(f"\r⏳ Running... {latest} ({files} files)", end='', flush=True)
    else:
        print("\r⏳ Starting...", end='', flush=True)
    time.sleep(1800)


CELL 7: Download Results
-------------------
import shutil
from google.colab import files

results_folders = sorted(glob.glob('nsga2_results/run_*'))
latest = results_folders[-1]

shutil.make_archive('pop100_results', 'zip', latest)
files.download('pop100_results.zip')

print(f"✓ Downloaded: {latest}")
